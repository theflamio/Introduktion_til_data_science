---
title: "Exercise - some linear models"
author: "Søren Højsgaard"
format: html
editor: visual
---

We will use the `palmerpenguins` data set. It is a data set with information on penguins. We will use the `body_mass_g` as the response variable and `species`, `island`, `sex`, `culmen_length_mm`, `culmen_depth_mm`, `flipper_length_mm`, and `year` as explanatory variables.

```{r}
dat <- palmerpenguins::penguins
dat <- dat[complete.cases(dat),]
head(dat)
```

We ask the following question:

1.  How well can we predict the body mass of a penguin based on species and flipper length?

2.  Are predictions improved by including other variables?

We encourage you to take as much inspiration from the lecture slides/notes as you feel like :)

```{r}
library(ggplot2) 
library(broom)
```

```{r}
dat |> ggplot(aes(flipper_length_mm, body_mass_g,color = species)) +
  geom_point()
```

```{r}
mm1 <- lm(body_mass_g ~ flipper_length_mm, data = dat)

ggplot(dat,aes(flipper_length_mm, body_mass_g)) +
  geom_point() +
  geom_line(aes(y = fitted(mm1)))
```

```{r}
mm1 |> tidy()
```

```{r}
# Model fits

mm1 |> glance()
```

```{r}
mm1 |> doBy::plot_lm()
```

```{r}

dat <- modelr::add_residuals(dat, mm1)

dat <- modelr::add_predictions(dat, mm1)

dat
```

```{r}
# Model evaluation



```
